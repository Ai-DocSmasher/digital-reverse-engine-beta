import numpy as npfrom scipy.io import wavfileimport librosaimport osdef load_audio(path: str):    ext = os.path.splitext(path)[1].lower()    # Try SciPy WAV loader ONLY if extension is .wav    if ext == ".wav":        try:            sr, audio = wavfile.read(path)            # Normalize to float32            if audio.dtype != np.float32:                audio = audio.astype(np.float32) / np.iinfo(audio.dtype).max            return audio, sr        except Exception:            # Fall back to librosa for mislabeled WAVs (FLAC/OGG/MP3/etc.)            audio, sr = librosa.load(path, sr=None, mono=False)            if audio.ndim > 1:                audio = audio.mean(axis=0)            return audio.astype(np.float32), sr    # All other formats â†’ use librosa    audio, sr = librosa.load(path, sr=None, mono=False)    if audio.ndim > 1:        audio = audio.mean(axis=0)    return audio.astype(np.float32), srdef save_wav(path: str, audio: np.ndarray, sample_rate: int):    audio_int16 = np.int16(audio * 32767)    wavfile.write(path, sample_rate, audio_int16)